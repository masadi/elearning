import{_ as me}from"./ConfirmDialog-B2A2Lgto.js";import{_ as pe}from"./ShowAlert-CsNMQtQV.js";import{r as T}from"./validators-BHkKs9Dp.js";import{r as u,j as ee,o as y,f as G,w as a,a as e,b as x,g as C,l as I,e as j,t as B,u as l,i as c,k as fe,p as K,c as F,F as Y,d as Z,s as ce,V as ve,m as Ve,n as S,q as ge}from"./main-DW5VCC58.js";import{_ as ae}from"./AppTextField-B1-hJZbi.js";/* empty css                       */import{$ as W}from"./api-CBRIaEF6.js";import{V as le}from"./VCard-CuZfBHUC.js";import{V as be,a as _e}from"./VToolbar-DJKGaqFN.js";import{V as te}from"./VSpacer-CHPoLg1n.js";import{V as ke}from"./VToolbarItems-D4-EMgPk.js";import{V as oe}from"./VCardText-DYlNs-5b.js";import{V as ye}from"./VForm-C7hd0Hig.js";import{V as A,a as p}from"./VRow-DP0F4OAf.js";import{V as H}from"./VAutocomplete-BlRWeaW4.js";import{V as je}from"./VFileInput-sWK_3XWR.js";import{V as De}from"./VTooltip-DiLtT_mW.js";import{V as he}from"./VImg-BFht51fA.js";import{V as xe}from"./VOverlay-DRtT-Rzv.js";import{V as Ce}from"./VDialog-BUNE5qoM.js";import{V as Pe,_ as qe}from"./VDataTableServer-C7-8KsRy.js";import{_ as Ue}from"./AppSelect-eDGR-LH7.js";import{u as we}from"./useApi-C8gPxuF8.js";import{c as Ae}from"./createUrl-PcBekDPf.js";import{V as $e}from"./VDivider-mCBUrhL5.js";import"./forwardRefs-D9kYFWgq.js";import"./VInput-DKZRgHWi.js";import"./VTextField-BnBMykLd.js";import"./index-BxkgbwWS.js";import"./VAvatar-XUhoRa9A.js";/* empty css              */import"./VList-u4Y2U10_.js";import"./ssrBoot-BDjid1kv.js";import"./VMenu-CsSG_iKb.js";import"./dialog-transition-DqsQIbqL.js";import"./VCheckboxBtn-D5pqMqc3.js";import"./VSelectionControl-C9AcoZtZ.js";import"./VChip-CNkFK8YP.js";const Te={class:"v-label text-body-2 text-high-emphasis",for:"deskripsi"},Se={class:"mb-2 d-flex align-center flex-wrap gap-4"},Fe={class:"mb-2 d-flex align-center flex-wrap gap-4"},Ie={__name:"PembelajaranAddDialog",props:{isDialogVisible:{type:Boolean,required:!0},sekolah:{type:Array,required:!0},mataPelajaran:{type:Array,required:!0},detilData:{type:Object,required:!1,default:null},sekolahId:{type:String,required:!1,default:null}},emits:["update:isDialogVisible","notif"],setup(E,{emit:P}){const d=E,m=u(!1),V=P,D=u(!1),b=u(),n=u({id:null,sekolah_id:d.sekolahId,mata_pelajaran_id:null,judul:null,foto:[],status:null}),q=u(1),_=u([{id:1,gambar:null}]),N=async()=>{var r;(r=b.value)==null||r.validate().then(async({valid:t})=>{if(t){m.value=!0;const f=new FormData;f.append("id",n.value.id??""),f.append("sekolah_id",n.value.sekolah_id??""),f.append("mata_pelajaran_id",n.value.mata_pelajaran_id??""),f.append("judul",n.value.judul??""),_.value.forEach(o=>{f.append(`foto[${o.id}]`,n.value.foto[o.id]??"")}),f.append("status",n.value.status??""),await W("/admin/pembelajaran/store",{method:"POST",body:f,onResponse({request:o,response:g,options:h}){let Q=g._data;$(),V("notif",Q)}})}})},$=()=>{V("update:isDialogVisible",!1),m.value=!1,n.value={id:null,sekolah_id:d.sekolahId,mata_pelajaran_id:null,judul:null,foto:[],status:null},_.value=[{id:1,gambar:null}],q.value=1},U=u([]);ee(d,async()=>{var r;d.isDialogVisible&&d.detilData&&(U.value=(r=d.detilData)==null?void 0:r.foto,n.value={id:d.detilData.pembelajaran_id,sekolah_id:d.detilData.sekolah_id,mata_pelajaran_id:d.detilData.mata_pelajaran_id,judul:d.detilData.judul,foto:[],status:d.detilData.status})});const k=[{title:"Aktif",value:"1"},{title:"Tidak Aktif",value:"0"}],R=()=>{_.value.push({id:q.value+=1})},J=(r,t)=>{_.value.splice(r,1),n.value.foto.splice(t,1),q.value=_.value.length},L=async r=>{console.log(r),U.value=U.value.filter(function(t){return t.id!==r}),await W(`/admin/pembelajaran/delete-foto/${r}`,{method:"DELETE",onResponse({request:t,response:f,options:o}){}})};return(r,t)=>{const f=ae;return y(),G(Ce,{fullscreen:"",scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":d.isDialogVisible,"onUpdate:modelValue":$},{default:a(()=>[e(le,null,{default:a(()=>[x("div",null,[e(be,{color:"primary"},{default:a(()=>[e(C,{icon:"",variant:"plain",onClick:$},{default:a(()=>[e(I,{color:"white",icon:"tabler-x"})]),_:1}),e(_e,null,{default:a(()=>[j(B(E.detilData?"Edit":"Tambah")+" Pembelajaran ",1)]),_:1}),e(te),e(ke,null,{default:a(()=>[e(C,{variant:"text",onClick:N,loading:l(m),disabled:l(m)},{default:a(()=>t[6]||(t[6]=[j("Simpan")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),e(oe,null,{default:a(()=>[e(l(ye),{ref_key:"refForm",ref:b,modelValue:l(D),"onUpdate:modelValue":t[4]||(t[4]=o=>c(D)?D.value=o:null),onSubmit:fe(N,["prevent"])},{default:a(()=>[e(A,null,{default:a(()=>[r.$can("create","laman-tentang-create")?K("",!0):(y(),G(p,{key:0,cols:"12"},{default:a(()=>[e(A,{"no-gutters":""},{default:a(()=>[e(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>t[7]||(t[7]=[x("label",{class:"v-label text-body-2 text-high-emphasis",for:"sekolah_id"},"Sekolah",-1)])),_:1}),e(p,{cols:"12",md:"9"},{default:a(()=>[e(H,{modelValue:l(n).sekolah_id,"onUpdate:modelValue":t[0]||(t[0]=o=>l(n).sekolah_id=o),variant:"outlined",items:E.sekolah,"item-title":"nama","item-value":"sekolah_id",placeholder:"== Pilih Sekolah ==",rules:["requiredValidator"in r?r.requiredValidator:l(T)]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})),e(p,{cols:"12"},{default:a(()=>[e(A,{"no-gutters":""},{default:a(()=>[e(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>t[8]||(t[8]=[x("label",{class:"v-label text-body-2 text-high-emphasis",for:"mata_pelajaran_id"},"Mata Pelajaran",-1)])),_:1}),e(p,{cols:"12",md:"9"},{default:a(()=>[e(H,{modelValue:l(n).mata_pelajaran_id,"onUpdate:modelValue":t[1]||(t[1]=o=>l(n).mata_pelajaran_id=o),variant:"outlined",items:d.mataPelajaran,"item-title":"nama","item-value":"id",placeholder:"== Pilih Mata Pelajaran ==",rules:["requiredValidator"in r?r.requiredValidator:l(T)]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(A,{"no-gutters":""},{default:a(()=>[e(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>t[9]||(t[9]=[x("label",{class:"v-label text-body-2 text-high-emphasis",for:"judul"},"Judul",-1)])),_:1}),e(p,{cols:"12",md:"9"},{default:a(()=>[e(f,{id:"judul",modelValue:l(n).judul,"onUpdate:modelValue":t[2]||(t[2]=o=>l(n).judul=o),rules:["requiredValidator"in r?r.requiredValidator:l(T)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(A,{"no-gutters":""},{default:a(()=>[e(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>t[10]||(t[10]=[x("label",{class:"v-label text-body-2 text-high-emphasis",for:"foto_id_gdrive"},"Status",-1)])),_:1}),e(p,{cols:"12",md:"9"},{default:a(()=>[e(H,{modelValue:l(n).status,"onUpdate:modelValue":t[3]||(t[3]=o=>l(n).status=o),variant:"outlined",items:k,placeholder:"== Pilih Status ==",rules:["requiredValidator"in r?r.requiredValidator:l(T)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(A,{"no-gutters":""},{default:a(()=>[e(p,{cols:"12",md:"3",class:"d-flex align-items-center align-start"},{default:a(()=>[x("label",Te,[t[12]||(t[12]=j(" Gambar ")),e(C,{variant:"text",onClick:R},{default:a(()=>[t[11]||(t[11]=j("Tambah Form ")),e(I,{end:"",icon:"tabler-copy"})]),_:1})])]),_:1}),e(p,{cols:"12",md:"9"},{default:a(()=>[(y(!0),F(Y,null,Z(l(_),(o,g)=>(y(),F("div",Se,[e(je,{accept:"image/*",label:`Gambar ${o.id}`,modelValue:l(n).foto[o.id],"onUpdate:modelValue":h=>l(n).foto[o.id]=h,rules:["requiredValidator"in r?r.requiredValidator:l(T)]},null,8,["label","modelValue","onUpdate:modelValue","rules"]),g>0?(y(),G(C,{key:0,color:"error",icon:"tabler-trash",onClick:h=>J(g,o.id)},null,8,["onClick"])):K("",!0)]))),256)),(y(!0),F(Y,null,Z(l(U),o=>(y(),F("div",Fe,[e(De,{bottom:""},{activator:a(({props:g})=>[e(C,ce({color:"primary",ref_for:!0},g),{default:a(()=>[j(B(o.foto),1)]),_:2},1040)]),default:a(()=>[e(he,{fluid:"",class:"align-end text-white",width:"300",src:`/storage/images/${o.foto}`},null,8,["src"])]),_:2},1024),e(C,{color:"error",icon:"tabler-trash",onClick:g=>L(o.id)},null,8,["onClick"])]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(xe,{modelValue:l(m),"onUpdate:modelValue":t[5]||(t[5]=o=>c(m)?m.value=o:null),contained:"",persistent:"","scroll-strategy":"none",class:"align-center justify-center"},{default:a(()=>[e(ve,{indeterminate:""})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])}}},Be={class:"d-flex gap-2 align-center"},Ee={class:"d-flex align-center flex-wrap gap-4"},Da={__name:"pembelajaran",async setup(E){let P,d;const m=u({icon:null,title:null,text:null,color:null}),V=u(!1),D=u(""),b=u(10),n=u(1),q=u("created_at"),_=u("DESC"),N=v=>{var i,w;v.sortBy.length&&(q.value=(i=v.sortBy[0])==null?void 0:i.key,_.value=(w=v.sortBy[0])==null?void 0:w.order)},$=[{title:"Judul",key:"judul",sortable:!1},{title:"mata pelajaran",key:"mata_pelajaran",sortable:!1},{title:"status",key:"status",sortable:!1},{title:"jml tes",key:"tes_count",sortable:!1,align:"center"},{title:"Actions",key:"actions",align:"center",sortable:!1}],U=v=>{m.value=v,V.value=!0},{data:k,execute:R}=([P,d]=Ve(()=>we(Ae("/table",{query:{data:"pembelajaran",q:D,itemsPerPage:b,page:n,sortBy:q,orderBy:_}}))),P=await P,d(),P);k.value.color&&(m.value=k.value,V.value=!0);const J=S(()=>k.value.lists.data),L=S(()=>k.value.lists.total),r=S(()=>k.value.sekolah),t=S(()=>k.value.sekolah_id),f=S(()=>k.value.mata_pelajaran),o=u(!1),g=u(),h=u(),Q=async v=>{g.value=v,h.value=!0},ie=async v=>{v&&await W(`/admin/pembelajaran/destroy/${g.value}`,{method:"DELETE",onResponse({request:i,response:w,options:X}){let M=w._data;m.value=M,V.value=!0,g.value=null,R()}})},O=u(),se=async v=>{o.value=!0,O.value=v};return ee(V,()=>{V.value||R()}),(v,i)=>{const w=Ue,X=ae,M=ge("IconBtn"),ne=qe,re=Ie,ue=pe,de=me;return y(),F("section",null,[e(le,null,{default:a(()=>[e(oe,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[x("div",Be,[e(w,{"model-value":l(b),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":i[0]||(i[0]=s=>b.value=parseInt(s,10))},null,8,["model-value"])]),e(te),x("div",Ee,[j(B(l(o))+" ",1),e(X,{modelValue:l(D),"onUpdate:modelValue":i[1]||(i[1]=s=>c(D)?D.value=s:null),placeholder:"Cari...",style:{"inline-size":"15.625rem"}},null,8,["modelValue"]),e(C,{onClick:i[2]||(i[2]=s=>o.value=!0)},{default:a(()=>[i[13]||(i[13]=j("Tambah ")),e(I,{end:"",icon:"tabler-cloud-upload"})]),_:1})])]),_:1}),e($e),e(Pe,{"items-per-page":l(b),"onUpdate:itemsPerPage":i[4]||(i[4]=s=>c(b)?b.value=s:null),page:l(n),"onUpdate:page":i[5]||(i[5]=s=>c(n)?n.value=s:null),"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],items:l(J),"items-length":l(L),headers:$,class:"text-no-wrap","onUpdate:options":N},{"item.mata_pelajaran":a(({item:s})=>{var z;return[j(B((z=s.mata_pelajaran)==null?void 0:z.nama),1)]}),"item.status":a(({item:s})=>[j(B(s.status==1?"Aktif":"Tidak Aktif"),1)]),"item.actions":a(({item:s})=>[e(M,{onClick:z=>Q(s.pembelajaran_id)},{default:a(()=>[e(I,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(M,{onClick:z=>se(s)},{default:a(()=>[e(I,{icon:"tabler-pencil"})]),_:2},1032,["onClick"])]),bottom:a(()=>[e(ne,{page:l(n),"onUpdate:page":i[3]||(i[3]=s=>c(n)?n.value=s:null),"items-per-page":l(b),"total-items":l(L)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),e(re,{"is-dialog-visible":l(o),"onUpdate:isDialogVisible":i[6]||(i[6]=s=>c(o)?o.value=s:null),onNotif:U,sekolah:l(r),"onUpdate:sekolah":i[7]||(i[7]=s=>c(r)?r.value=s:null),sekolahId:l(t),"onUpdate:sekolahId":i[8]||(i[8]=s=>c(t)?t.value=s:null),"detil-data":l(O),"onUpdate:detilData":i[9]||(i[9]=s=>c(O)?O.value=s:null),mataPelajaran:l(f),"onUpdate:mataPelajaran":i[10]||(i[10]=s=>c(f)?f.value=s:null)},null,8,["is-dialog-visible","sekolah","sekolahId","detil-data","mataPelajaran"]),l(m).color?(y(),G(ue,{key:0,color:l(m).color,icon:l(m).icon,title:l(m).title,text:l(m).text,"disable-time-out":!1,isSnackbarVisible:l(V),"onUpdate:isSnackbarVisible":i[11]||(i[11]=s=>c(V)?V.value=s:null)},null,8,["color","icon","title","text","isSnackbarVisible"])):K("",!0),e(de,{isDialogVisible:l(h),"onUpdate:isDialogVisible":i[12]||(i[12]=s=>c(h)?h.value=s:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","show-notif":!1,onConfirm:ie},null,8,["isDialogVisible"])])}}};export{Da as default};
