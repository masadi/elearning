import{a as ya}from"./formatters-DULOiX1-.js";import{_ as Da}from"./ConfirmDialog-DFbzgQW8.js";import{_ as wa}from"./ShowAlert-DfFAv44p.js";import{r as R}from"./validators-BHkKs9Dp.js";import{r as u,C as na,l as Z,o as w,m as F,w as e,b as a,a as T,V as S,v as B,d as q,t as E,u as l,D as ia,p as U,h as ra,E as O,c as Q,F as sa,x as da,j as xa,k as J,q as qa,s as Ca}from"./main-CJqJ5jgX.js";import{_ as aa}from"./AppTextField-BNKfsWJc.js";import{$ as H}from"./api-C1l3fXy6.js";import{V as ea}from"./VCard-BoPs5wzw.js";import{V as ua,a as pa,b as ma}from"./VToolbarItems-Dp1Dbzg0.js";import{V as la}from"./VSpacer-D7tKLNB5.js";import{V as ta}from"./VCardText-Dyk9rFBW.js";import{V as fa}from"./VForm-BfSbkl8_.js";import{V as M,a as _}from"./VRow-C4R7jrb-.js";import{V as z}from"./VAutocomplete-CtSd9p8P.js";import{V as X}from"./VChip-DxlNBE8M.js";import{V as Y}from"./VList-BxrZyx63.js";import{V as va}from"./VDialog-DcAvQr3h.js";import{V as Ua,_ as Ta,a as ha}from"./VDataTableServer-MiFAOmgu.js";import{u as ja}from"./useApi-Crmmmh9g.js";import{c as Fa}from"./createUrl-XQL3s935.js";import{V as Pa}from"./VDivider-BMkwtQos.js";import{V as Aa}from"./VAvatar-TRklItJV.js";import{V as Ra}from"./VImg-DRPIkl48.js";import"./VOverlay-BB1DNga5.js";import"./forwardRefs-D9kYFWgq.js";import"./VTextField-BhLkXAqD.js";import"./index-9rIf2CJL.js";/* empty css              */import"./filter-Bgaj9e79.js";import"./dialog-transition-Bu6FTd__.js";import"./VMenu-BM9B6Kyn.js";import"./VCheckboxBtn-DyTQd6So.js";const Sa={__name:"RombelDetilDialog",props:{isDialogVisible:{type:Boolean,required:!0},detilData:{type:Object,required:!0}},emits:["update:isDialogVisible","notif"],setup(K,{emit:$}){const y=K,D=$,f=u([{id:1,ptk_id:null,mata_pelajaran_id:null,nama_mata_pelajaran:null}]),C=u(2),k=u(!1),x=u(),N=async()=>{var o;(o=x.value)==null||o.validate().then(async({valid:n})=>{if(n){const s=new FormData;s.append("data","update-rombel"),s.append("rombongan_belajar_id",b.value.rombongan_belajar_id),s.append("nama",b.value.nama),s.append("wali_id",b.value.ptk_id),s.append("tingkat",b.value.tingkat),f.value.forEach(t=>{s.append("ptk_id[]",t.ptk_id?t.ptk_id:""),s.append("mata_pelajaran_id[]",t.mata_pelajaran_id?t.mata_pelajaran_id:""),s.append("nama_mata_pelajaran[]",t.nama_mata_pelajaran?t.nama_mata_pelajaran:"")}),await H("/referensi/store",{method:"POST",body:s,onResponse({request:t,response:d,options:p}){let m=d._data;j(),D("notif",m)}})}})},j=()=>{D("update:isDialogVisible",!1),f.value=[{id:1,ptk_id:null,rombongan_belajar_id:null}],C.value=2},G=()=>{f.value.push({id:C.value+=C.value})},L=o=>{f.value.splice(o,1)},P=u([]),h=u([]),I=u(!0),b=u(structuredClone(na(y.detilData)));Z(y,async()=>{b.value=structuredClone(na(y.detilData)),y.isDialogVisible&&(V("ptk"),V("mapel"))});const V=async o=>{await H("/referensi",{query:{data:o},onResponse({request:n,response:s,options:t}){let d=s._data;o=="ptk"&&(P.value=d),o=="mapel"&&(h.value=d),I.value=!1}})},v=[10,11,12,13],g=(o,n)=>{const s=h.value.find(t=>t.id===n);console.log(s),f.value[o].nama_mata_pelajaran=s.nama};return(o,n)=>{const s=aa;return w(),F(va,{fullscreen:"",scrim:!1,scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":y.isDialogVisible,"onUpdate:modelValue":j},{default:e(()=>[a(ea,null,{default:e(()=>[T("div",null,[a(ua,{color:"primary"},{default:e(()=>[a(S,{icon:"",variant:"plain",onClick:j},{default:e(()=>[a(B,{color:"white",icon:"tabler-x"})]),_:1}),a(pa,null,{default:e(()=>[q("Detil Rombel "+E(l(b).nama),1)]),_:1}),a(la),a(ma,null,{default:e(()=>[a(S,{variant:"text",onClick:G},{default:e(()=>[n[4]||(n[4]=q("Tambah Form ")),a(B,{end:"",icon:"tabler-copy"})]),_:1}),a(S,{variant:"text",onClick:N},{default:e(()=>n[5]||(n[5]=[q("Simpan")])),_:1})]),_:1})]),_:1})]),a(ta,null,{default:e(()=>[l(I)?(w(),F(ia,{key:0,indeterminate:"",color:"warning",size:"150"})):(w(),F(l(fa),{key:1,ref_key:"refForm",ref:x,modelValue:l(k),"onUpdate:modelValue":n[3]||(n[3]=t=>U(k)?k.value=t:null),onSubmit:ra(N,["prevent"])},{default:e(()=>[a(M,null,{default:e(()=>[a(_,{cols:"12"},{default:e(()=>[a(M,null,{default:e(()=>[a(_,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>n[6]||(n[6]=[T("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-nama"},"Nama Rombel",-1)])),_:1}),a(_,{cols:"12",md:"9"},{default:e(()=>[a(s,{id:"nama",modelValue:l(b).nama,"onUpdate:modelValue":n[0]||(n[0]=t=>l(b).nama=t),rules:["requiredValidator"in o?o.requiredValidator:l(R)]},{label:e(()=>n[7]||(n[7]=[q("Nama Rombel")])),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(_,{cols:"12"},{default:e(()=>[a(M,null,{default:e(()=>[a(_,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>n[8]||(n[8]=[T("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-tingkat"},"Tingkat",-1)])),_:1}),a(_,{cols:"12",md:"9"},{default:e(()=>[a(z,{modelValue:l(b).tingkat,"onUpdate:modelValue":n[1]||(n[1]=t=>l(b).tingkat=t),label:"Tingkat",variant:"outlined",items:v,placeholder:"== Pilih Tingkat ==",rules:["requiredValidator"in o?o.requiredValidator:l(R)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(_,{cols:"12"},{default:e(()=>[a(M,null,{default:e(()=>[a(_,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>n[9]||(n[9]=[T("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-ptk_id"},"Wali Kelas",-1)])),_:1}),a(_,{cols:"12",md:"9"},{default:e(()=>[a(z,{chips:"",modelValue:l(b).ptk_id,"onUpdate:modelValue":n[2]||(n[2]=t=>l(b).ptk_id=t),label:"Guru",variant:"outlined",items:l(P),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in o?o.requiredValidator:l(R)]},{chip:e(({props:t,item:d})=>[a(X,O(t,{"prepend-avatar":d.raw.avatar,text:d.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:t,item:d})=>{var p,m,c;return[a(Y,O(t,{"prepend-avatar":(p=d==null?void 0:d.raw)==null?void 0:p.avatar,title:(m=d==null?void 0:d.raw)==null?void 0:m.nama,subtitle:(c=d==null?void 0:d.raw)==null?void 0:c.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:1},8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1}),a(_,{cols:"12"},{default:e(()=>n[10]||(n[10]=[T("h2",null,"Pembelajaran",-1)])),_:1})]),_:1}),(w(!0),Q(sa,null,da(l(f),(t,d)=>(w(),F(M,{id:t.id,key:t.id},{default:e(()=>[a(_,{md:"4"},{default:e(()=>[a(z,{modelValue:t.mata_pelajaran_id,"onUpdate:modelValue":[p=>t.mata_pelajaran_id=p,p=>g(d,p)],label:"Mata Pelajaran",variant:"outlined",items:l(h),"item-title":"nama","item-value":"id",placeholder:"== Pilih Mata Pelajaran ==",rules:["requiredValidator"in o?o.requiredValidator:l(R)]},null,8,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(_,{md:"4"},{default:e(()=>[a(s,{modelValue:t.nama_mata_pelajaran,"onUpdate:modelValue":p=>t.nama_mata_pelajaran=p,rules:["requiredValidator"in o?o.requiredValidator:l(R)]},{label:e(()=>n[11]||(n[11]=[q("Nama Mata Pelajaran")])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(_,{md:"3"},{default:e(()=>[a(z,{chips:"",modelValue:t.ptk_id,"onUpdate:modelValue":p=>t.ptk_id=p,label:"Guru",variant:"outlined",items:l(P),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in o?o.requiredValidator:l(R)]},{chip:e(({props:p,item:m})=>[a(X,O({ref_for:!0},p,{"prepend-avatar":m.raw.avatar,text:m.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:p,item:m})=>{var c,r,A;return[a(Y,O({ref_for:!0},p,{"prepend-avatar":(c=m==null?void 0:m.raw)==null?void 0:c.avatar,title:(r=m==null?void 0:m.raw)==null?void 0:r.nama,subtitle:(A=m==null?void 0:m.raw)==null?void 0:A.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:2},1032,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(_,{md:"1"},{default:e(()=>[a(S,{block:"",color:"warning",onClick:p=>L(d)},{default:e(()=>[a(B,{icon:"tabler-x"}),n[12]||(n[12]=q(" Hapus"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Ba={__name:"RombelAddDialog",props:{isDialogVisible:{type:Boolean,required:!0},sekolah:{type:Object,required:!0}},emits:["update:isDialogVisible","notif"],setup(K,{emit:$}){const y=K,D=$,f=u([{id:1,nama:null,tingkat:null,ptk_id:null}]),C=u(2),k=u(!1),x=u(),N=async()=>{var V;(V=x.value)==null||V.validate().then(async({valid:v})=>{if(v){const g=new FormData;g.append("data","rombel"),g.append("sekolah_id",y.sekolah.sekolah_id),f.value.forEach(o=>{g.append("nama[]",o.nama?o.nama:""),g.append("tingkat[]",o.tingkat?o.tingkat:""),g.append("ptk_id[]",o.ptk_id?o.ptk_id:"")}),await H("/referensi/store",{method:"POST",body:g,onResponse({request:o,response:n,options:s}){let t=n._data;j(),D("notif",t)}})}})},j=()=>{D("update:isDialogVisible",!1),f.value=[{id:1,mapel_id:null,nama:null,alias:null}],C.value=2},G=()=>{f.value.push({id:C.value+=C.value})},L=V=>{f.value.splice(V,1)},P=u([]),h=[10,11,12,13],I=u(!0);Z(y,async()=>{console.log(y),y.isDialogVisible&&b("ptk")});const b=async V=>{await H("/referensi",{query:{data:V},onResponse({request:v,response:g,options:o}){let n=g._data;P.value=n,I.value=!1}})};return(V,v)=>{const g=aa;return w(),F(va,{fullscreen:"",scrim:!1,scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":y.isDialogVisible,"onUpdate:modelValue":j},{default:e(()=>[a(ea,null,{default:e(()=>[T("div",null,[a(ua,{color:"primary"},{default:e(()=>[a(S,{icon:"",variant:"plain",onClick:j},{default:e(()=>[a(B,{color:"white",icon:"tabler-x"})]),_:1}),a(pa,null,{default:e(()=>v[1]||(v[1]=[q("Tambah Rombongan Belajar")])),_:1}),a(la),a(ma,null,{default:e(()=>[a(S,{variant:"text",onClick:G},{default:e(()=>[v[2]||(v[2]=q("Tambah Form ")),a(B,{end:"",icon:"tabler-copy"})]),_:1}),a(S,{variant:"text",onClick:N},{default:e(()=>v[3]||(v[3]=[q("Simpan")])),_:1})]),_:1})]),_:1})]),a(ta,null,{default:e(()=>[l(I)?(w(),F(ia,{key:0,indeterminate:"",color:"warning",size:"150"})):(w(),F(l(fa),{key:1,ref_key:"refForm",ref:x,modelValue:l(k),"onUpdate:modelValue":v[0]||(v[0]=o=>U(k)?k.value=o:null),onSubmit:ra(N,["prevent"])},{default:e(()=>[(w(!0),Q(sa,null,da(l(f),(o,n)=>(w(),F(M,{id:o.id,key:o.id},{default:e(()=>[a(_,{md:"5"},{default:e(()=>[a(g,{id:"nama",modelValue:o.nama,"onUpdate:modelValue":s=>o.nama=s,rules:["requiredValidator"in V?V.requiredValidator:l(R)]},{label:e(()=>v[4]||(v[4]=[q("Nama Rombel")])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(_,{md:"2"},{default:e(()=>[a(z,{modelValue:o.tingkat,"onUpdate:modelValue":s=>o.tingkat=s,label:"Tingkat",variant:"outlined",items:h,placeholder:"== Pilih Tingkat ==",rules:["requiredValidator"in V?V.requiredValidator:l(R)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(_,{md:"4"},{default:e(()=>[a(z,{chips:"",label:"Wali Kelas",variant:"outlined",items:l(P),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",modelValue:o.ptk_id,"onUpdate:modelValue":s=>o.ptk_id=s,rules:["requiredValidator"in V?V.requiredValidator:l(R)]},{chip:e(({props:s,item:t})=>[a(X,O({ref_for:!0},s,{"prepend-avatar":t.raw.avatar,text:t.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:s,item:t})=>{var d,p,m;return[a(Y,O({ref_for:!0},s,{"prepend-avatar":(d=t==null?void 0:t.raw)==null?void 0:d.avatar,title:(p=t==null?void 0:t.raw)==null?void 0:p.nama,subtitle:(m=t==null?void 0:t.raw)==null?void 0:m.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:2},1032,["items","modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(_,{md:"1"},{default:e(()=>[a(S,{color:"warning",onClick:s=>L(n)},{default:e(()=>[a(B,{icon:"tabler-x"}),v[5]||(v[5]=q(" Hapus"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}}},$a={class:"d-flex gap-2 align-center"},Na={class:"d-flex align-center flex-wrap gap-4"},Ia={class:"d-flex align-center gap-x-4"},Ea={key:1},Ma={class:"d-flex flex-column"},Oa={class:"text-base"},za={class:"text-sm"},De={__name:"rombel",async setup(K){let $,y;const D=u({icon:null,title:null,text:null,color:null}),f=u(!1),C=u(""),k=u(10),x=u(1),N=u("tingkat"),j=u("ASC"),G=c=>{var r,A;c.sortBy.length&&(N.value=(r=c.sortBy[0])==null?void 0:r.key,j.value=(A=c.sortBy[0])==null?void 0:A.order)},L=[{title:"nama",key:"nama"},{title:"tingkat",key:"tingkat"},{title:"wali kelas",key:"walas",sortable:!1},{title:"Actions",key:"actions",align:"center",sortable:!1}],P=c=>{D.value=c,f.value=!0},{data:h,execute:I}=([$,y]=xa(()=>ja(Fa("/table",{query:{data:"rombel",q:C,itemsPerPage:k,page:x,sortBy:N,orderBy:j}}))),$=await $,y(),$);h.value.color&&(D.value=h.value,f.value=!0);const b=J(()=>h.value.lists.data),V=J(()=>h.value.lists.total),v=J(()=>h.value.sekolah),g=u(!1),o=u(),n=u(),s=async c=>{o.value=c,n.value=!0},t=async c=>{c&&await H(`/referensi/destroy/mapel/${o.value}`,{method:"DELETE",onResponse({request:r,response:A,options:oa}){let W=A._data;D.value=W,f.value=!0,o.value=null,I()}})},d=u(!1),p=u(),m=async c=>{d.value=!0,p.value=c};return Z(f,()=>{f.value||I()}),(c,r)=>{const A=Ta,oa=aa,W=Ca("IconBtn"),ca=ha,Va=Ba,_a=Sa,ga=wa,ba=Da;return w(),Q("section",null,[a(ea,null,{default:e(()=>[a(ta,{class:"d-flex flex-wrap gap-4"},{default:e(()=>[T("div",$a,[a(A,{"model-value":l(k),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":r[0]||(r[0]=i=>k.value=parseInt(i,10))},null,8,["model-value"])]),a(la),T("div",Na,[a(oa,{modelValue:l(C),"onUpdate:modelValue":r[1]||(r[1]=i=>U(C)?C.value=i:null),placeholder:"Cari...",style:{"inline-size":"15.625rem"}},null,8,["modelValue"]),a(S,{onClick:r[2]||(r[2]=i=>g.value=!0)},{default:e(()=>[r[12]||(r[12]=q("Tambah ")),a(B,{end:"",icon:"tabler-cloud-upload"})]),_:1})])]),_:1}),a(Pa),a(Ua,{"items-per-page":l(k),"onUpdate:itemsPerPage":r[4]||(r[4]=i=>U(k)?k.value=i:null),page:l(x),"onUpdate:page":r[5]||(r[5]=i=>U(x)?x.value=i:null),"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],items:l(b),"items-length":l(V),headers:L,class:"text-no-wrap","onUpdate:options":G},{"item.walas":e(({item:i})=>[T("div",Ia,[a(Aa,{size:"34",variant:i.walas.avatar?void 0:"tonal",color:i.walas.avatar?void 0:"success"},{default:e(()=>[i.walas.avatar?(w(),F(Ra,{key:0,src:i.walas.avatar},null,8,["src"])):(w(),Q("span",Ea,E(("avatarText"in c?c.avatarText:l(ya))(i.walas.name)),1))]),_:2},1032,["variant","color"]),T("div",Ma,[T("h6",Oa,E(i.walas.nama),1),T("div",za,E(i.walas.email),1)])])]),"item.ttl":e(({item:i})=>[q(E(i.tempat_lahir)+", "+E(new Date(i.tanggal_lahir).toLocaleString("id-ID",{hour12:!1,day:"numeric",month:"long",year:"numeric"})),1)]),"item.actions":e(({item:i})=>[a(W,{onClick:ka=>s(i.id)},{default:e(()=>[a(B,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),a(W,{onClick:ka=>m(i)},{default:e(()=>[a(B,{icon:"tabler-pencil"})]),_:2},1032,["onClick"])]),bottom:e(()=>[a(ca,{page:l(x),"onUpdate:page":r[3]||(r[3]=i=>U(x)?x.value=i:null),"items-per-page":l(k),"total-items":l(V)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),a(Va,{"is-dialog-visible":l(g),"onUpdate:isDialogVisible":r[6]||(r[6]=i=>U(g)?g.value=i:null),sekolah:l(v),"onUpdate:sekolah":r[7]||(r[7]=i=>U(v)?v.value=i:null),onNotif:P},null,8,["is-dialog-visible","sekolah"]),a(_a,{"is-dialog-visible":l(d),"onUpdate:isDialogVisible":r[8]||(r[8]=i=>U(d)?d.value=i:null),"detil-data":l(p),"onUpdate:detilData":r[9]||(r[9]=i=>U(p)?p.value=i:null),onNotif:P},null,8,["is-dialog-visible","detil-data"]),l(D).color?(w(),F(ga,{key:0,color:l(D).color,icon:l(D).icon,title:l(D).title,text:l(D).text,"disable-time-out":!1,isSnackbarVisible:l(f),"onUpdate:isSnackbarVisible":r[10]||(r[10]=i=>U(f)?f.value=i:null)},null,8,["color","icon","title","text","isSnackbarVisible"])):qa("",!0),a(ba,{isDialogVisible:l(n),"onUpdate:isDialogVisible":r[11]||(r[11]=i=>U(n)?n.value=i:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","show-notif":!1,onConfirm:t},null,8,["isDialogVisible"])])}}};export{De as default};
