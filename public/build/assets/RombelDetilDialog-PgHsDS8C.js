import{r as V}from"./validators-BHkKs9Dp.js";import{r as m,i as G,j as W,o as g,h as j,w as e,a,b as k,g as w,V as P,f as _,t as J,u as i,m as Q,k as X,l as Y,n as y,c as Z,F as aa,d as ea}from"./main-CtoGanBy.js";import{_ as la}from"./AppTextField-DKIruqF8.js";import{$ as I}from"./api-CfY-i2-f.js";import{V as ta}from"./VCard-BoltQYMn.js";import{V as ra,a as oa}from"./VToolbar-D31a0SiZ.js";import{V as ia}from"./VSpacer-NEJdFdmN.js";import{V as na}from"./VToolbarItems-Vi_eNLVV.js";import{V as da}from"./VCardText-C7fhsdeL.js";import{V as sa}from"./VForm-M3UmGq5W.js";import{V as c,a as u}from"./VRow-Cf05TlGb.js";import{V as D}from"./VAutocomplete-wP7YBuob.js";import{V as $}from"./VChip-Bg4qHmcR.js";import{V as O}from"./VList-BvHnNEl8.js";import{V as ua}from"./VDialog-CMarGgU7.js";const xa={__name:"RombelDetilDialog",props:{isDialogVisible:{type:Boolean,required:!0},detilData:{type:Object,required:!0}},emits:["update:isDialogVisible","notif"],setup(A,{emit:E}){const b=A,U=E,f=m([{id:1,ptk_id:null,mata_pelajaran_id:null,nama_mata_pelajaran:null}]),q=m(2),x=m(!1),h=m(),R=async()=>{var r;(r=h.value)==null||r.validate().then(async({valid:l})=>{if(l){const n=new FormData;n.append("data","update-rombel"),n.append("rombongan_belajar_id",p.value.rombongan_belajar_id),n.append("nama",p.value.nama),n.append("wali_id",p.value.ptk_id),n.append("tingkat",p.value.tingkat),f.value.forEach(t=>{n.append("ptk_id[]",t.ptk_id?t.ptk_id:""),n.append("mata_pelajaran_id[]",t.mata_pelajaran_id?t.mata_pelajaran_id:""),n.append("nama_mata_pelajaran[]",t.nama_mata_pelajaran?t.nama_mata_pelajaran:"")}),await I("/referensi/store",{method:"POST",body:n,onResponse({request:t,response:o,options:s}){let d=o._data;C(),U("notif",d)}})}})},C=()=>{U("update:isDialogVisible",!1),f.value=[{id:1,ptk_id:null,rombongan_belajar_id:null}],q.value=2},L=()=>{f.value.push({id:q.value+=q.value})},z=r=>{f.value.splice(r,1)},T=m([]),F=m([]),B=m(!0),p=m(structuredClone(G(b.detilData)));W(b,async()=>{p.value=structuredClone(G(b.detilData)),b.isDialogVisible&&(M("ptk"),M("mapel"))});const M=async r=>{await I("/referensi",{query:{data:r},onResponse({request:l,response:n,options:t}){let o=n._data;r=="ptk"&&(T.value=o),r=="mapel"&&(F.value=o),B.value=!1}})},H=[10,11,12,13],K=(r,l)=>{const n=F.value.find(t=>t.id===l);console.log(n),f.value[r].nama_mata_pelajaran=n.nama};return(r,l)=>{const n=la;return g(),j(ua,{fullscreen:"",scrim:!1,scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":b.isDialogVisible,"onUpdate:modelValue":C},{default:e(()=>[a(ta,null,{default:e(()=>[k("div",null,[a(ra,{color:"primary"},{default:e(()=>[a(w,{icon:"",variant:"plain",onClick:C},{default:e(()=>[a(P,{color:"white",icon:"tabler-x"})]),_:1}),a(oa,null,{default:e(()=>[_("Detil Rombel "+J(i(p).nama),1)]),_:1}),a(ia),a(na,null,{default:e(()=>[a(w,{variant:"text",onClick:L},{default:e(()=>[l[4]||(l[4]=_("Tambah Form ")),a(P,{end:"",icon:"tabler-copy"})]),_:1}),a(w,{variant:"text",onClick:R},{default:e(()=>l[5]||(l[5]=[_("Simpan")])),_:1})]),_:1})]),_:1})]),a(da,null,{default:e(()=>[i(B)?(g(),j(Q,{key:0,indeterminate:"",color:"warning",size:"150"})):(g(),j(i(sa),{key:1,ref_key:"refForm",ref:h,modelValue:i(x),"onUpdate:modelValue":l[3]||(l[3]=t=>X(x)?x.value=t:null),onSubmit:Y(R,["prevent"])},{default:e(()=>[a(c,null,{default:e(()=>[a(u,{cols:"12"},{default:e(()=>[a(c,null,{default:e(()=>[a(u,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>l[6]||(l[6]=[k("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-nama"},"Nama Rombel",-1)])),_:1}),a(u,{cols:"12",md:"9"},{default:e(()=>[a(n,{id:"nama",modelValue:i(p).nama,"onUpdate:modelValue":l[0]||(l[0]=t=>i(p).nama=t),rules:["requiredValidator"in r?r.requiredValidator:i(V)]},{label:e(()=>l[7]||(l[7]=[_("Nama Rombel")])),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:e(()=>[a(c,null,{default:e(()=>[a(u,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>l[8]||(l[8]=[k("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-tingkat"},"Tingkat",-1)])),_:1}),a(u,{cols:"12",md:"9"},{default:e(()=>[a(D,{modelValue:i(p).tingkat,"onUpdate:modelValue":l[1]||(l[1]=t=>i(p).tingkat=t),label:"Tingkat",variant:"outlined",items:H,placeholder:"== Pilih Tingkat ==",rules:["requiredValidator"in r?r.requiredValidator:i(V)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:e(()=>[a(c,null,{default:e(()=>[a(u,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>l[9]||(l[9]=[k("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-ptk_id"},"Wali Kelas",-1)])),_:1}),a(u,{cols:"12",md:"9"},{default:e(()=>[a(D,{chips:"",modelValue:i(p).ptk_id,"onUpdate:modelValue":l[2]||(l[2]=t=>i(p).ptk_id=t),label:"Guru",variant:"outlined",items:i(T),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in r?r.requiredValidator:i(V)]},{chip:e(({props:t,item:o})=>[a($,y(t,{"prepend-avatar":o.raw.avatar,text:o.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:t,item:o})=>{var s,d,v;return[a(O,y(t,{"prepend-avatar":(s=o==null?void 0:o.raw)==null?void 0:s.avatar,title:(d=o==null?void 0:o.raw)==null?void 0:d.nama,subtitle:(v=o==null?void 0:o.raw)==null?void 0:v.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:1},8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:e(()=>l[10]||(l[10]=[k("h2",null,"Pembelajaran",-1)])),_:1})]),_:1}),(g(!0),Z(aa,null,ea(i(f),(t,o)=>(g(),j(c,{id:t.id,key:t.id},{default:e(()=>[a(u,{md:"4"},{default:e(()=>[a(D,{modelValue:t.mata_pelajaran_id,"onUpdate:modelValue":[s=>t.mata_pelajaran_id=s,s=>K(o,s)],label:"Mata Pelajaran",variant:"outlined",items:i(F),"item-title":"nama","item-value":"id",placeholder:"== Pilih Mata Pelajaran ==",rules:["requiredValidator"in r?r.requiredValidator:i(V)]},null,8,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(u,{md:"4"},{default:e(()=>[a(n,{modelValue:t.nama_mata_pelajaran,"onUpdate:modelValue":s=>t.nama_mata_pelajaran=s,rules:["requiredValidator"in r?r.requiredValidator:i(V)]},{label:e(()=>l[11]||(l[11]=[_("Nama Mata Pelajaran")])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(u,{md:"3"},{default:e(()=>[a(D,{chips:"",modelValue:t.ptk_id,"onUpdate:modelValue":s=>t.ptk_id=s,label:"Guru",variant:"outlined",items:i(T),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in r?r.requiredValidator:i(V)]},{chip:e(({props:s,item:d})=>[a($,y({ref_for:!0},s,{"prepend-avatar":d.raw.avatar,text:d.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:s,item:d})=>{var v,N,S;return[a(O,y({ref_for:!0},s,{"prepend-avatar":(v=d==null?void 0:d.raw)==null?void 0:v.avatar,title:(N=d==null?void 0:d.raw)==null?void 0:N.nama,subtitle:(S=d==null?void 0:d.raw)==null?void 0:S.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:2},1032,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(u,{md:"1"},{default:e(()=>[a(w,{block:"",color:"warning",onClick:s=>z(o)},{default:e(()=>[a(P,{icon:"tabler-x"}),l[12]||(l[12]=_(" Hapus"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{xa as _};
