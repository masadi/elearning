import{r as c}from"./validators-BHkKs9Dp.js";import{r as V,aJ as L,O as W,o as g,h as w,w as e,a,b as F,g as y,V as h,f as k,t as sa,u as n,aG as J,k as Q,B as X,x,c as Y,F as Z,d as aa}from"./main-DDhzifcV.js";import{_ as ea}from"./AppTextField-zCzlzxfC.js";import{$ as M}from"./api-BlliS3fq.js";import{V as la}from"./VCard-ClcQXOLU.js";import{V as ta,a as oa}from"./VToolbar-D40tqNhf.js";import{V as ra}from"./VSpacer-CU2FsF2o.js";import{V as na}from"./VToolbarItems-Bfg9n4dd.js";import{V as ia}from"./VCardText-DfQa0cKd.js";import{V as da}from"./VForm-YhPA2UsG.js";import{V as U,a as s}from"./VRow-rbxT3h3B.js";import{V as C}from"./VAutocomplete-DTTRJiil.js";import{V as E}from"./VChip-Dr6GSJP5.js";import{V as z}from"./VList-B_QfjsxU.js";import{V as ua}from"./VDialog-B3caFRi4.js";const Ta={__name:"RombelDetilDialog",props:{isDialogVisible:{type:Boolean,required:!0},detilData:{type:Object,required:!0}},emits:["update:isDialogVisible","notif"],setup(O,{emit:$}){const v=O,R=$,_=V([{id:1,ptk_id:null,mata_pelajaran_id:null,nama_mata_pelajaran:null}]),D=V(2),q=V(!1),P=V(),B=async()=>{var t;(t=P.value)==null||t.validate().then(async({valid:o})=>{if(o){const r=new FormData;r.append("data","update-rombel"),r.append("rombongan_belajar_id",f.value.rombongan_belajar_id),r.append("nama",f.value.nama),r.append("wali_id",f.value.ptk_id),r.append("tingkat",f.value.tingkat),_.value.forEach(l=>{r.append("ptk_id[]",l.ptk_id?l.ptk_id:""),r.append("mata_pelajaran_id[]",l.mata_pelajaran_id?l.mata_pelajaran_id:""),r.append("nama_mata_pelajaran[]",l.nama_mata_pelajaran?l.nama_mata_pelajaran:"")}),await M("/referensi/store",{method:"POST",body:r,onResponse({request:l,response:i,options:u}){let d=i._data;j(),R("notif",d)}})}})},j=()=>{R("update:isDialogVisible",!1),_.value=[{id:1,ptk_id:null,rombongan_belajar_id:null}],D.value=2},I=()=>{_.value.push({id:D.value+=D.value})},A=t=>{_.value.splice(t,1)},T=V([]),S=V([]),N=V(!0),f=V(structuredClone(L(v.detilData)));W(v,async()=>{f.value=structuredClone(L(v.detilData)),v.isDialogVisible&&(m("ptk"),m("mapel"))});const m=async t=>{await M("/referensi",{query:{data:t},onResponse({request:o,response:r,options:l}){let i=r._data;t=="ptk"&&(T.value=i),t=="mapel"&&(S.value=i),N.value=!1}})},p=[10,11,12,13],b=(t,o)=>{const r=S.value.find(l=>l.id===o);console.log(r),_.value[t].nama_mata_pelajaran=r.nama};return(t,o)=>{const r=ea;return g(),w(ua,{fullscreen:"",scrim:!1,scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":v.isDialogVisible,"onUpdate:modelValue":j},{default:e(()=>[a(la,null,{default:e(()=>[F("div",null,[a(ta,{color:"primary"},{default:e(()=>[a(y,{icon:"",variant:"plain",onClick:j},{default:e(()=>[a(h,{color:"white",icon:"tabler-x"})]),_:1}),a(oa,null,{default:e(()=>[k("Detil Rombel "+sa(n(f).nama),1)]),_:1}),a(ra),a(na,null,{default:e(()=>[a(y,{variant:"text",onClick:I},{default:e(()=>[o[4]||(o[4]=k("Tambah Form ")),a(h,{end:"",icon:"tabler-copy"})]),_:1}),a(y,{variant:"text",onClick:B},{default:e(()=>o[5]||(o[5]=[k("Simpan")])),_:1})]),_:1})]),_:1})]),a(ia,null,{default:e(()=>[n(N)?(g(),w(J,{key:0,indeterminate:"",color:"warning",size:"150"})):(g(),w(n(da),{key:1,ref_key:"refForm",ref:P,modelValue:n(q),"onUpdate:modelValue":o[3]||(o[3]=l=>Q(q)?q.value=l:null),onSubmit:X(B,["prevent"])},{default:e(()=>[a(U,null,{default:e(()=>[a(s,{cols:"12"},{default:e(()=>[a(U,null,{default:e(()=>[a(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>o[6]||(o[6]=[F("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-nama"},"Nama Rombel",-1)])),_:1}),a(s,{cols:"12",md:"9"},{default:e(()=>[a(r,{id:"nama",modelValue:n(f).nama,"onUpdate:modelValue":o[0]||(o[0]=l=>n(f).nama=l),rules:["requiredValidator"in t?t.requiredValidator:n(c)]},{label:e(()=>o[7]||(o[7]=[k("Nama Rombel")])),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(s,{cols:"12"},{default:e(()=>[a(U,null,{default:e(()=>[a(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>o[8]||(o[8]=[F("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-tingkat"},"Tingkat",-1)])),_:1}),a(s,{cols:"12",md:"9"},{default:e(()=>[a(C,{modelValue:n(f).tingkat,"onUpdate:modelValue":o[1]||(o[1]=l=>n(f).tingkat=l),label:"Tingkat",variant:"outlined",items:p,placeholder:"== Pilih Tingkat ==",rules:["requiredValidator"in t?t.requiredValidator:n(c)]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),a(s,{cols:"12"},{default:e(()=>[a(U,null,{default:e(()=>[a(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:e(()=>o[9]||(o[9]=[F("label",{class:"v-label text-body-2 text-high-emphasis",for:"app-text-field-ptk_id"},"Wali Kelas",-1)])),_:1}),a(s,{cols:"12",md:"9"},{default:e(()=>[a(C,{chips:"",modelValue:n(f).ptk_id,"onUpdate:modelValue":o[2]||(o[2]=l=>n(f).ptk_id=l),label:"Guru",variant:"outlined",items:n(T),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in t?t.requiredValidator:n(c)]},{chip:e(({props:l,item:i})=>[a(E,x(l,{"prepend-avatar":i.raw.avatar,text:i.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:l,item:i})=>{var u,d,G;return[a(z,x(l,{"prepend-avatar":(u=i==null?void 0:i.raw)==null?void 0:u.avatar,title:(d=i==null?void 0:i.raw)==null?void 0:d.nama,subtitle:(G=i==null?void 0:i.raw)==null?void 0:G.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:1},8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1}),a(s,{cols:"12"},{default:e(()=>o[10]||(o[10]=[F("h2",null,"Pembelajaran",-1)])),_:1})]),_:1}),(g(!0),Y(Z,null,aa(n(_),(l,i)=>(g(),w(U,{id:l.id,key:l.id},{default:e(()=>[a(s,{md:"4"},{default:e(()=>[a(C,{modelValue:l.mata_pelajaran_id,"onUpdate:modelValue":[u=>l.mata_pelajaran_id=u,u=>b(i,u)],label:"Mata Pelajaran",variant:"outlined",items:n(S),"item-title":"nama","item-value":"id",placeholder:"== Pilih Mata Pelajaran ==",rules:["requiredValidator"in t?t.requiredValidator:n(c)]},null,8,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(s,{md:"4"},{default:e(()=>[a(r,{modelValue:l.nama_mata_pelajaran,"onUpdate:modelValue":u=>l.nama_mata_pelajaran=u,rules:["requiredValidator"in t?t.requiredValidator:n(c)]},{label:e(()=>o[11]||(o[11]=[k("Nama Mata Pelajaran")])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(s,{md:"3"},{default:e(()=>[a(C,{chips:"",modelValue:l.ptk_id,"onUpdate:modelValue":u=>l.ptk_id=u,label:"Guru",variant:"outlined",items:n(T),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",rules:["requiredValidator"in t?t.requiredValidator:n(c)]},{chip:e(({props:u,item:d})=>[a(E,x({ref_for:!0},u,{"prepend-avatar":d.raw.avatar,text:d.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:u,item:d})=>{var G,H,K;return[a(z,x({ref_for:!0},u,{"prepend-avatar":(G=d==null?void 0:d.raw)==null?void 0:G.avatar,title:(H=d==null?void 0:d.raw)==null?void 0:H.nama,subtitle:(K=d==null?void 0:d.raw)==null?void 0:K.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:2},1032,["modelValue","onUpdate:modelValue","items","rules"])]),_:2},1024),a(s,{md:"1"},{default:e(()=>[a(y,{block:"",color:"warning",onClick:u=>A(i)},{default:e(()=>[a(h,{icon:"tabler-x"}),o[12]||(o[12]=k(" Hapus"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Fa={__name:"RombelAddDialog",props:{isDialogVisible:{type:Boolean,required:!0},sekolah:{type:Object,required:!0}},emits:["update:isDialogVisible","notif"],setup(O,{emit:$}){const v=O,R=$,_=V([{id:1,nama:null,tingkat:null,ptk_id:null}]),D=V(2),q=V(!1),P=V(),B=async()=>{var m;(m=P.value)==null||m.validate().then(async({valid:p})=>{if(p){const b=new FormData;b.append("data","rombel"),b.append("sekolah_id",v.sekolah.sekolah_id),_.value.forEach(t=>{b.append("nama[]",t.nama?t.nama:""),b.append("tingkat[]",t.tingkat?t.tingkat:""),b.append("ptk_id[]",t.ptk_id?t.ptk_id:"")}),await M("/referensi/store",{method:"POST",body:b,onResponse({request:t,response:o,options:r}){let l=o._data;j(),R("notif",l)}})}})},j=()=>{R("update:isDialogVisible",!1),_.value=[{id:1,mapel_id:null,nama:null,alias:null}],D.value=2},I=()=>{_.value.push({id:D.value+=D.value})},A=m=>{_.value.splice(m,1)},T=V([]),S=[10,11,12,13],N=V(!0);W(v,async()=>{console.log(v),v.isDialogVisible&&f("ptk")});const f=async m=>{await M("/referensi",{query:{data:m},onResponse({request:p,response:b,options:t}){let o=b._data;T.value=o,N.value=!1}})};return(m,p)=>{const b=ea;return g(),w(ua,{fullscreen:"",scrim:!1,scrollable:"","content-class":"scrollable-dialog",transition:"dialog-bottom-transition","model-value":v.isDialogVisible,"onUpdate:modelValue":j},{default:e(()=>[a(la,null,{default:e(()=>[F("div",null,[a(ta,{color:"primary"},{default:e(()=>[a(y,{icon:"",variant:"plain",onClick:j},{default:e(()=>[a(h,{color:"white",icon:"tabler-x"})]),_:1}),a(oa,null,{default:e(()=>p[1]||(p[1]=[k("Tambah Rombongan Belajar")])),_:1}),a(ra),a(na,null,{default:e(()=>[a(y,{variant:"text",onClick:I},{default:e(()=>[p[2]||(p[2]=k("Tambah Form ")),a(h,{end:"",icon:"tabler-copy"})]),_:1}),a(y,{variant:"text",onClick:B},{default:e(()=>p[3]||(p[3]=[k("Simpan")])),_:1})]),_:1})]),_:1})]),a(ia,null,{default:e(()=>[n(N)?(g(),w(J,{key:0,indeterminate:"",color:"warning",size:"150"})):(g(),w(n(da),{key:1,ref_key:"refForm",ref:P,modelValue:n(q),"onUpdate:modelValue":p[0]||(p[0]=t=>Q(q)?q.value=t:null),onSubmit:X(B,["prevent"])},{default:e(()=>[(g(!0),Y(Z,null,aa(n(_),(t,o)=>(g(),w(U,{id:t.id,key:t.id},{default:e(()=>[a(s,{md:"5"},{default:e(()=>[a(b,{id:"nama",modelValue:t.nama,"onUpdate:modelValue":r=>t.nama=r,rules:["requiredValidator"in m?m.requiredValidator:n(c)]},{label:e(()=>p[4]||(p[4]=[k("Nama Rombel")])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(s,{md:"2"},{default:e(()=>[a(C,{modelValue:t.tingkat,"onUpdate:modelValue":r=>t.tingkat=r,label:"Tingkat",variant:"outlined",items:S,placeholder:"== Pilih Tingkat ==",rules:["requiredValidator"in m?m.requiredValidator:n(c)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(s,{md:"4"},{default:e(()=>[a(C,{chips:"",label:"Wali Kelas",variant:"outlined",items:n(T),"item-title":"nama","item-value":"ptk_id",placeholder:"== Pilih Guru ==",modelValue:t.ptk_id,"onUpdate:modelValue":r=>t.ptk_id=r,rules:["requiredValidator"in m?m.requiredValidator:n(c)]},{chip:e(({props:r,item:l})=>[a(E,x({ref_for:!0},r,{"prepend-avatar":l.raw.avatar,text:l.raw.name}),null,16,["prepend-avatar","text"])]),item:e(({props:r,item:l})=>{var i,u,d;return[a(z,x({ref_for:!0},r,{"prepend-avatar":(i=l==null?void 0:l.raw)==null?void 0:i.avatar,title:(u=l==null?void 0:l.raw)==null?void 0:u.nama,subtitle:(d=l==null?void 0:l.raw)==null?void 0:d.email}),null,16,["prepend-avatar","title","subtitle"])]}),_:2},1032,["items","modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(s,{md:"1"},{default:e(()=>[a(y,{color:"warning",onClick:r=>A(o)},{default:e(()=>[a(h,{icon:"tabler-x"}),p[5]||(p[5]=k(" Hapus"))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["id"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{Fa as _,Ta as a};
